{"version":3,"file":"view.js","mappings":"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","sources":["webpack://mega-menu-block/external module \"@wordpress/interactivity\"","webpack://mega-menu-block/webpack/bootstrap","webpack://mega-menu-block/webpack/runtime/make namespace object","webpack://mega-menu-block/./src/view.js"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\tif (!(moduleId in __webpack_modules__)) {\n\t\tdelete __webpack_module_cache__[moduleId];\n\t\tvar e = new Error(\"Cannot find module '\" + moduleId + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * WordPress dependencies\n */\nimport { store, getContext, getElement } from '@wordpress/interactivity';\n\nconst { state, actions } = store( 'uwd/mega-menu', {\n\tstate: {\n\t\tget isMenuOpen() {\n\t\t\t// The menu is opened if either `click` or `focus` is true.\n\t\t\treturn (\n\t\t\t\tObject.values( state.menuOpenedBy ).filter( Boolean ).length > 0\n\t\t\t);\n\t\t},\n\t\tget menuOpenedBy() {\n\t\t\tconst context = getContext();\n\t\t\treturn context.menuOpenedBy;\n\t\t},\n\t},\n\tactions: {\n\t\thandleToggleMousedown() {\n\t\t\t// Set a flag before focusout fires so handleMenuFocusout knows\n\t\t\t// not to close the menu when the toggle button itself is clicked.\n\t\t\t// This is needed because Safari sets relatedTarget to null on click.\n\t\t\tconst context = getContext();\n\t\t\tcontext.isTogglingMenu = true;\n\t\t},\n\t\ttoggleMenuOnClick() {\n\t\t\tconst context = getContext();\n\t\t\tconst { ref } = getElement();\n\t\t\t// Safari won't send focus to the clicked element, so we need to manually place it: https://bugs.webkit.org/show_bug.cgi?id=22261\n\t\t\tif ( window.document.activeElement !== ref ) ref.focus();\n\n\t\t\tcontext.isTogglingMenu = false;\n\n\t\t\tif ( state.menuOpenedBy.click || state.menuOpenedBy.focus ) {\n\t\t\t\tactions.closeMenu( 'click' );\n\t\t\t\tactions.closeMenu( 'focus' );\n\t\t\t} else {\n\t\t\t\tcontext.previousFocus = ref;\n\t\t\t\t// Store the toggle's bottom position so slide-in panels can\n\t\t\t\t// use position:fixed but still start below the toggle button.\n\t\t\t\tconst li = ref.closest( '.wp-block-uwd-mega-menu' );\n\t\t\t\tif ( li ) {\n\t\t\t\t\tli.style.setProperty(\n\t\t\t\t\t\t'--slide-in-top',\n\t\t\t\t\t\t`${ ref.getBoundingClientRect().bottom + 20 }px`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tactions.openMenu( 'click' );\n\t\t\t}\n\t\t},\n\t\tcloseMenuOnClick() {\n\t\t\tactions.closeMenu( 'click' );\n\t\t\tactions.closeMenu( 'focus' );\n\t\t},\n\t\thandleMenuKeydown( event ) {\n\t\t\tif ( state.menuOpenedBy.click ) {\n\t\t\t\t// If Escape close the menu.\n\t\t\t\tif ( event?.key === 'Escape' ) {\n\t\t\t\t\tactions.closeMenu( 'click' );\n\t\t\t\t\tactions.closeMenu( 'focus' );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\thandleMenuFocusout( event ) {\n\t\t\tconst context = getContext();\n\t\t\tconst menuContainer = context.megaMenu?.querySelector(\n\t\t\t\t'.wp-block-uwd-mega-menu__menu-container'\n\t\t\t);\n\t\t\t// If focus is outside menu, and in the document, close menu\n\t\t\t// event.target === The element losing focus\n\t\t\t// event.relatedTarget === The element receiving focus (if any)\n\t\t\t// When focusout is outside the document,\n\t\t\t// `window.document.activeElement` doesn't change.\n\n\t\t\t// If the toggle button is being clicked (tracked via mousedown), skip\n\t\t\t// closing here â€” toggleMenuOnClick will handle it. This fixes a Safari\n\t\t\t// bug where relatedTarget is always null on click, which previously\n\t\t\t// caused focusout to close the menu before the click reopened it.\n\t\t\tif ( context.isTogglingMenu ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// The event.relatedTarget is null when something outside the navigation menu is clicked. This is only necessary for Safari.\n\t\t\tif (\n\t\t\t\tevent.relatedTarget === null ||\n\t\t\t\t( ! menuContainer?.contains( event.relatedTarget ) &&\n\t\t\t\t\tevent.target !== window.document.activeElement )\n\t\t\t) {\n\t\t\t\tactions.closeMenu( 'click' );\n\t\t\t\tactions.closeMenu( 'focus' );\n\t\t\t}\n\t\t},\n\t\topenMenu( menuOpenedOn = 'click' ) {\n\t\t\tstate.menuOpenedBy[ menuOpenedOn ] = true;\n\t\t},\n\t\tcloseMenu( menuClosedOn = 'click' ) {\n\t\t\tconst context = getContext();\n\t\t\tstate.menuOpenedBy[ menuClosedOn ] = false;\n\n\t\t\t// Reset the menu reference and button focus when closed.\n\t\t\tif ( ! state.isMenuOpen ) {\n\t\t\t\tif (\n\t\t\t\t\tcontext.megaMenu?.contains( window.document.activeElement )\n\t\t\t\t) {\n\t\t\t\t\tcontext.previousFocus?.focus();\n\t\t\t\t}\n\t\t\t\tcontext.previousFocus = null;\n\t\t\t\tcontext.megaMenu = null;\n\t\t\t}\n\t\t},\n\t},\n\tcallbacks: {\n\t\tinitMenu() {\n\t\t\tconst context = getContext();\n\t\t\tconst { ref } = getElement();\n\n\t\t\t// Set the menu reference when initialized.\n\t\t\tif ( state.isMenuOpen ) {\n\t\t\t\tcontext.megaMenu = ref;\n\t\t\t}\n\t\t},\n\t},\n} );\n"],"names":["store","getContext","getElement","state","actions","isMenuOpen","Object","values","menuOpenedBy","filter","Boolean","length","context","handleToggleMousedown","isTogglingMenu","toggleMenuOnClick","ref","window","document","activeElement","focus","click","closeMenu","previousFocus","li","closest","style","setProperty","getBoundingClientRect","bottom","openMenu","closeMenuOnClick","handleMenuKeydown","event","key","handleMenuFocusout","menuContainer","megaMenu","querySelector","relatedTarget","contains","target","menuOpenedOn","menuClosedOn","callbacks","initMenu"],"sourceRoot":""}