{"version":3,"file":"view.js","mappings":"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","sources":["webpack://mega-menu-block/external module \"@wordpress/interactivity\"","webpack://mega-menu-block/webpack/bootstrap","webpack://mega-menu-block/webpack/runtime/make namespace object","webpack://mega-menu-block/./src/view.js"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\tif (!(moduleId in __webpack_modules__)) {\n\t\tdelete __webpack_module_cache__[moduleId];\n\t\tvar e = new Error(\"Cannot find module '\" + moduleId + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * WordPress dependencies\n */\nimport { store, getContext, getElement } from '@wordpress/interactivity';\n\n// Timeout IDs for hover-close delays, keyed by the <li> DOM ref.\n// Cannot store in WP Interactivity context because getContext() is only\n// valid during synchronous event dispatch — not inside setTimeout callbacks.\nconst hoverTimeouts = new WeakMap();\n\nconst { state, actions } = store( 'uwd/mega-menu', {\n\tstate: {\n\t\tget isMenuOpen() {\n\t\t\t// The menu is opened if either `click` or `focus` is true.\n\t\t\treturn (\n\t\t\t\tObject.values( state.menuOpenedBy ).filter( Boolean ).length > 0\n\t\t\t);\n\t\t},\n\t\tget menuOpenedBy() {\n\t\t\tconst context = getContext();\n\t\t\treturn context.menuOpenedBy;\n\t\t},\n\t},\n\tactions: {\n\t\thandleToggleMousedown() {\n\t\t\t// Set a flag before focusout fires so handleMenuFocusout knows\n\t\t\t// not to close the menu when the toggle button itself is clicked.\n\t\t\t// This is needed because Safari sets relatedTarget to null on click.\n\t\t\tconst context = getContext();\n\t\t\tcontext.isTogglingMenu = true;\n\t\t},\n\t\ttoggleMenuOnClick() {\n\t\t\tconst context = getContext();\n\t\t\tconst { ref } = getElement();\n\t\t\t// Safari won't send focus to the clicked element, so we need to manually place it: https://bugs.webkit.org/show_bug.cgi?id=22261\n\t\t\tif ( window.document.activeElement !== ref ) ref.focus();\n\n\t\t\tcontext.isTogglingMenu = false;\n\n\t\t\tif ( state.menuOpenedBy.click || state.menuOpenedBy.focus ) {\n\t\t\t\tactions.closeMenu( 'click' );\n\t\t\t\tactions.closeMenu( 'focus' );\n\t\t\t} else {\n\t\t\t\tcontext.previousFocus = ref;\n\n\t\t\t\tconst li = ref.closest( '.wp-block-uwd-mega-menu' );\n\t\t\t\tif ( li ) {\n\t\t\t\t\t// Calculate the left offset so that translateX(-50%) centers\n\t\t\t\t\t// the dropdown on the viewport, regardless of the li's position.\n\t\t\t\t\t// --dropdown-left = (viewport center) - (li's left edge in viewport)\n\t\t\t\t\tconst liLeft = li.getBoundingClientRect().left;\n\t\t\t\t\tconst cssLeft = ( document.documentElement.clientWidth / 2 ) - liLeft;\n\t\t\t\t\tli.style.setProperty( '--dropdown-left', `${ cssLeft }px` );\n\n\t\t\t\t\tconst rect = ref.getBoundingClientRect();\n\t\t\t\t\tli.style.setProperty( '--slide-in-top', `${ rect.bottom + 20 }px` );\n\t\t\t\t}\n\n\t\t\t\tactions.openMenu( 'click' );\n\t\t\t}\n\t\t},\n\t\tcloseMenuOnClick() {\n\t\t\tactions.closeMenu( 'click' );\n\t\t\tactions.closeMenu( 'focus' );\n\t\t\tactions.closeMenu( 'hover' );\n\t\t},\n\t\thandleMenuMouseenter() {\n\t\t\tconst context = getContext();\n\t\t\tif ( context.triggerOn !== 'hover' ) return;\n\t\t\tconst { ref } = getElement(); // ref is the <li>\n\n\t\t\t// Cancel any pending close timeout — covers the gap between the\n\t\t\t// toggle button and the dropdown, and hovering back in after leaving.\n\t\t\tif ( hoverTimeouts.has( ref ) ) {\n\t\t\t\tclearTimeout( hoverTimeouts.get( ref ) );\n\t\t\t\thoverTimeouts.delete( ref );\n\t\t\t}\n\n\t\t\t// Calculate centering offsets (same logic as click trigger).\n\t\t\tconst liLeft = ref.getBoundingClientRect().left;\n\t\t\tconst cssLeft = ( document.documentElement.clientWidth / 2 ) - liLeft;\n\t\t\tref.style.setProperty( '--dropdown-left', `${ cssLeft }px` );\n\n\t\t\tconst toggleBtn = ref.querySelector( '.wp-block-uwd-mega-menu__toggle' );\n\t\t\tif ( toggleBtn ) {\n\t\t\t\tconst rect = toggleBtn.getBoundingClientRect();\n\t\t\t\tref.style.setProperty( '--slide-in-top', `${ rect.bottom + 20 }px` );\n\t\t\t\tcontext.previousFocus = toggleBtn;\n\t\t\t}\n\n\t\t\tactions.openMenu( 'hover' );\n\t\t},\n\t\thandleMenuMouseleave() {\n\t\t\tconst context = getContext();\n\t\t\tif ( context.triggerOn !== 'hover' ) return;\n\t\t\tconst { ref } = getElement();\n\n\t\t\t// context is captured synchronously here. Inside the timeout we\n\t\t\t// mutate the reactive proxy directly — we cannot call closeMenu()\n\t\t\t// or any action that calls getContext() from an async callback.\n\t\t\tif ( hoverTimeouts.has( ref ) ) {\n\t\t\t\tclearTimeout( hoverTimeouts.get( ref ) );\n\t\t\t}\n\t\t\tconst id = setTimeout( () => {\n\t\t\t\thoverTimeouts.delete( ref );\n\t\t\t\tcontext.menuOpenedBy.hover = false;\n\t\t\t\tif ( ! Object.values( context.menuOpenedBy ).some( Boolean ) ) {\n\t\t\t\t\tif ( context.megaMenu?.contains( window.document.activeElement ) ) {\n\t\t\t\t\t\tcontext.previousFocus?.focus();\n\t\t\t\t\t}\n\t\t\t\t\tcontext.previousFocus = null;\n\t\t\t\t\tcontext.megaMenu = null;\n\t\t\t\t}\n\t\t\t}, 200 );\n\t\t\thoverTimeouts.set( ref, id );\n\t\t},\n\t\thandleMenuKeydown( event ) {\n\t\t\tif ( state.menuOpenedBy.click || state.menuOpenedBy.hover ) {\n\t\t\t\t// If Escape close the menu.\n\t\t\t\tif ( event?.key === 'Escape' ) {\n\t\t\t\t\tactions.closeMenu( 'click' );\n\t\t\t\t\tactions.closeMenu( 'focus' );\n\t\t\t\t\tactions.closeMenu( 'hover' );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\thandleMenuFocusout( event ) {\n\t\t\tconst context = getContext();\n\t\t\tconst menuContainer = context.megaMenu?.querySelector(\n\t\t\t\t'.wp-block-uwd-mega-menu__menu-container'\n\t\t\t);\n\t\t\t// If focus is outside menu, and in the document, close menu\n\t\t\t// event.target === The element losing focus\n\t\t\t// event.relatedTarget === The element receiving focus (if any)\n\t\t\t// When focusout is outside the document,\n\t\t\t// `window.document.activeElement` doesn't change.\n\n\t\t\t// If the toggle button is being clicked (tracked via mousedown), skip\n\t\t\t// closing here — toggleMenuOnClick will handle it. This fixes a Safari\n\t\t\t// bug where relatedTarget is always null on click, which previously\n\t\t\t// caused focusout to close the menu before the click reopened it.\n\t\t\tif ( context.isTogglingMenu ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// The event.relatedTarget is null when something outside the navigation menu is clicked. This is only necessary for Safari.\n\t\t\tif (\n\t\t\t\tevent.relatedTarget === null ||\n\t\t\t\t( ! menuContainer?.contains( event.relatedTarget ) &&\n\t\t\t\t\tevent.target !== window.document.activeElement )\n\t\t\t) {\n\t\t\t\tactions.closeMenu( 'click' );\n\t\t\t\tactions.closeMenu( 'focus' );\n\t\t\t\tactions.closeMenu( 'hover' );\n\t\t\t}\n\t\t},\n\t\topenMenu( menuOpenedOn = 'click' ) {\n\t\t\tstate.menuOpenedBy[ menuOpenedOn ] = true;\n\t\t},\n\t\tcloseMenu( menuClosedOn = 'click' ) {\n\t\t\tconst context = getContext();\n\t\t\tstate.menuOpenedBy[ menuClosedOn ] = false;\n\n\t\t\t// Reset the menu reference and button focus when closed.\n\t\t\tif ( ! state.isMenuOpen ) {\n\t\t\t\tif (\n\t\t\t\t\tcontext.megaMenu?.contains( window.document.activeElement )\n\t\t\t\t) {\n\t\t\t\t\tcontext.previousFocus?.focus();\n\t\t\t\t}\n\t\t\t\tcontext.previousFocus = null;\n\t\t\t\tcontext.megaMenu = null;\n\t\t\t}\n\t\t},\n\t},\n\tcallbacks: {\n\t\tinitMenu() {\n\t\t\tconst context = getContext();\n\t\t\tconst { ref } = getElement();\n\n\t\t\t// Set the menu reference when initialized.\n\t\t\tif ( state.isMenuOpen ) {\n\t\t\t\tcontext.megaMenu = ref;\n\t\t\t}\n\t\t},\n\t},\n} );\n"],"names":["store","getContext","getElement","hoverTimeouts","WeakMap","state","actions","isMenuOpen","Object","values","menuOpenedBy","filter","Boolean","length","context","handleToggleMousedown","isTogglingMenu","toggleMenuOnClick","ref","window","document","activeElement","focus","click","closeMenu","previousFocus","li","closest","liLeft","getBoundingClientRect","left","cssLeft","documentElement","clientWidth","style","setProperty","rect","bottom","openMenu","closeMenuOnClick","handleMenuMouseenter","triggerOn","has","clearTimeout","get","delete","toggleBtn","querySelector","handleMenuMouseleave","id","setTimeout","hover","some","megaMenu","contains","set","handleMenuKeydown","event","key","handleMenuFocusout","menuContainer","relatedTarget","target","menuOpenedOn","menuClosedOn","callbacks","initMenu"],"sourceRoot":""}