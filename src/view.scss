// Front-end specific styles.
.wp-block-uwd-mega-menu {
	$self: &;
	&__menu-container {
		visibility: hidden;
		opacity: 0;
		transition: transform .3s ease, visibility .3s ease, opacity .3s ease;
		
		// Prevent Mega Menu from inheriting styles from Navigation Block.
		color: initial;
		font-weight: initial;
		font-size: initial;
		letter-spacing: initial;
		line-height: initial;
		text-decoration: initial;
		text-transform: initial;
		
		// Menu Modes
		&.mode-is-dropdown {
			left: 0;
			overflow: hidden;
			position: absolute;
			top: calc(100% + 20px);
			transform: translateX(-50%);
			width: 0;
			// Invisible bridge that fills the 20px gap between the toggle and the
			// menu. The mouse stays over a descendant of the <li> while crossing
			// the gap, so mouseleave never fires and the menu stays open.
			&::before {
				content: '';
				position: absolute;
				top: -20px;
				left: 0;
				right: 0;
				height: 20px;
			}
		}
		&.mode-is-slide-in-left, &.mode-is-slide-in-right {
			height: calc(100vh - var(--slide-in-top, 0px));
			overflow-y: auto;
			position: fixed;
			top: var(--slide-in-top, 0px);
		}
		&.mode-is-slide-in-right {
			right: 0;
			transform: translateX(100%);
		}
		&.mode-is-slide-in-left {
			left: 0;
			transform: translateX(-100%);
		}
		
		// Close Button
		.menu-container__close-button {
			position: absolute;
			right: 12px;
			top: 12px;
			background-color: transparent;
			border: none;
			cursor: pointer;
		}
		
		// Ensures nav menu inside mega menus display correctly.
		.is-responsive {
			display: flex;
		}
	}
	
	// Show the mega menu when toggle is active.
	&__toggle[aria-expanded="true"] {
		~ #{$self}__menu-container {
			visibility: visible;
			opacity: 1;
			z-index: 99999;
		}
		~ #{$self}__menu-container.mode-is-dropdown {
			left: var(--dropdown-left, 50vw);
			overflow: visible;
			width: min(100vw, var(--wp--style--global--wide-size));
			transform: translateX(-50%);
		}
		~ #{$self}__menu-container.mode-is-slide-in-right {
			transform: translateX(0);
		}
		~ #{$self}__menu-container.mode-is-slide-in-left {
			transform: translateX(0);
		}
	}
}

// If there is a collapsed link, start hidden.
.wp-block-uwd-mega-menu__collapsed-link {
	display: none;
}

// If a navigation modal is open, check if the mega menu should be displayed.
html.has-modal-open {
	.wp-block-uwd-mega-menu {
		&.disable-menu-when-collapsed {
			&:not(.has-collapsed-link) {
				display: none;
			}
			.wp-block-uwd-mega-menu__collapsed-link {
				display: inherit;
			}
			.wp-block-uwd-mega-menu__toggle, 
			.wp-block-uwd-mega-menu__menu-container {
				display: none;
			}
		}
	}
}